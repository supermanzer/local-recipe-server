services:
  gateway:
    volumes:
      # Local development overrides - no HTTPS needed
      - ./gateway/nginx.conf:/etc/nginx/conf.d/default.conf
      - ./gateway/nginx-ssl-dev.conf:/etc/nginx/conf.d/nginx-ssl.conf
      # Note: /etc/letsencrypt mount is omitted for local dev

  nuxt:
    # Override to use Node.js image for development instead of nginx
    build: {}  # Disable the build from docker-compose.yml
    image: node:20
    working_dir: /app
    restart: no  # Don't restart on failure during dev
    command: sh -c "npm install && npm run dev"
    volumes:
      - ./nuxt/recipe_client:/app
      - /app/node_modules  # Prevent host node_modules from overwriting container's
    ports:
      - "3000:8900"  # Expose Nuxt dev server for local development
    environment:
      - API_BASE=/api
